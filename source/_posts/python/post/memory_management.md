---
title: 파이썬의 메모리 관리 번역
p: python/post/memory_management
date: 2019-06-19 18:20:11
tags: ['python', 'memory', 'python post']
---

파이썬 내의 메모리 관리는 사적인 힙을 포함한다, 모든 파이썬 객체와 자료구조를 포함하는.
이 프라이빗한 힙의 관리는 내부적으로 파이썬 메모리 관리자에의해 보장받는다.
파이썬 메모리 관리자는 다른 컴포넌트들을 가지고 있다, 다양한 다이나믹 저장소 관리 측면에서 업무를 하는.
예를 들면 공유 분할, 선할당 혹은 캐싱처럼 말이다.

가장 낮은 레벨에서 본래 메모리 할당자는 보장한다, 프라이빗 힙엔 충분한 방이 있다고, 모든 파이썬 관련 데이터를 보관하기 위해, 운영체제의 메모리 관리자와 소통함으로써.
순수 메모리 할당자 위에, 몆몆 객체-특정 할당자가 동일한 힙에서 작동하고, 개별적인 메모리 관리 정책을 수행한다, specific 모든 객체 타입에 대해 적용되는 정책.
예를 들면 정수객체는 힙안에서 문자객체들, 튜플객체들 혹은 딕셔너리 객체들과 다르게 관리된다 힙 안에서, 왜냐하면, 정수는 다른 저장소 요구사항을 적용받고, 속도와 스페이스에 있어서 트레이드 오프가 있기 때문이다.
파이썬 메모리 관리자는 그러므로 특정-객체 할당자들에게 일부 업무들에 있어서 달라붙는다. 그러나 후에 연산이 실행됨이 프라이빗 힙에서 진행된다는 것을 보장한다.

이것은 중요하다 이해하는 것에 있어서, 파이썬 개인힙의 관리가 인터프리터 그 자체로 의해 진행되고, 유저는 그것에 대한 컨트롤이 없다는 것, 비록 만약 유저들이 주기적으로, 자주 객체들이 힙의 메모리 블락을 가르키도록 다루더라도 말이다. 힙-스페이스에 대한 메모리 할당에 있어서 파이썬 객체들은 그리고 다른 내부적인 버퍼들은 파이썬 메모리 관리자에 의해서 요구되는 것으로 인해 실행된다. Python/C API functions가 그들의 문사에 리스트화 된 것을 통해서.

충돌을 막기 위해, 확장된 작성자들은 절때 파이썬 객체를 C라이브러리에서 송출된 함수들로 조정하려 해서는 안된다.
C라이브러리: malloc(), calloc(), realloc() and free().
이것은 결과로 할것이다, 뒤섞인 호출들, C-할당자와 파이썬 메모리 매니저 사이에, 치명적인 결과와 함께, 왜냐하면 그들은 다른 알고리즘을 수행하고, 다른 힙에서 구동되기 때문이다. 그러나 한가지는 안전하게 할당되고 메모리블럭들을 놓아줄수 있다. 특별한 목적을 위한 c-라이브러리 할당자에 의해서. 그 예시는 아래예시이다.
```python
PyObject *res;
char *buf = (char *) malloc(BUFSIZ); /*for I/O*/

if (buf == NULL)
    return PyErr_NoMemory();
#...Do some I/O operation involving buf...
res = PyBytes_FromString(buf);
free(buf)' /*malloc'ed*/
return res;
```
이 예제에서, 메모리의 I/O버퍼에 대한 요청은 C-라이브러리 할당자에 의해서 이루어진다. 파이썬 메모리 매니저는 오직 문자객체가 결과로서 리턴되는 것의 할당에관해서만 관련된다.

대부분의 상황에서, 그러나, 이것은 추천된다, 메모리를 파이썬 힙으로부터 구체적으로 할당하는 것을. 왜냐하면 나중의 문제는 파이썬 메모리 매니저에 의해서 관리될 수 있기 때문이다. 예를 들어 이것은 요구된다 인터프리터가 C로 작성된 새로운 객체타입으로 확장되었을때. 다른 이유로 파이썬 힙을 사용하는 것은 파이썬 메모리 매니저에게 알리기 위해서 이다. 확장된 모듈에 대한 메모리 요구를.
만약 요구된 메모리가 예외적으로 내부적으로 사용되고, 높은 수준의 특별한 목적에 의해 사용하더라도, 파이썬 메모리 매니저에게 메모리에 관한 모든 요구를 찾아 올려보내는 것은 인터프리터로 하여금 더 많은 이것의 메모리 전체 기록에 관한 정확한 이미지를 요구하도록 야기할 것이다. 결과적으로, 특정 환경 아래에서, 파이썬 메모리 관리자는 적절한 액션을 취할 수 있고 아닐 수 있다. 예를 들면 Garbage-collection 처럼, 메모리 컴팩트화 혹은 다른 예방차원의 과정을. C-라이브러리를 이전 예제처럼 사용하는 것은, I/O버퍼를 위해 할당된 메모리가 파이썬 매니저로부터 도망가도록 한다는 것을 기억하라.