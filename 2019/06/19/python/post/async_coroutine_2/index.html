<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  

  
  <title>비동기 코루틴 번역-2 | Junehan&#39;s workbook</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Coroutines 우리는 당신을 Promise로 유도하고 싶다. 비동기처리에 대해서 콜백의 효율성과 조합하여 과거 멀티쓰레딩 프로그래밍의 클래식한 것을 사용해서 작성하는 것이 가능하다. 이 조합은 &amp;quot;Coroutine&amp;quot;이라는 패턴과 함께 얻을 수 있는 것이다. 1234@async.coroutinedef fetch(self,url):">
<meta name="keywords" content="python,python post">
<meta property="og:type" content="article">
<meta property="og:title" content="비동기 코루틴 번역-2">
<meta property="og:url" content="https://codenamenadja.github.io/2019/06/19/python/post/async_coroutine_2/index.html">
<meta property="og:site_name" content="Junehan&#39;s workbook">
<meta property="og:description" content="Coroutines 우리는 당신을 Promise로 유도하고 싶다. 비동기처리에 대해서 콜백의 효율성과 조합하여 과거 멀티쓰레딩 프로그래밍의 클래식한 것을 사용해서 작성하는 것이 가능하다. 이 조합은 &amp;quot;Coroutine&amp;quot;이라는 패턴과 함께 얻을 수 있는 것이다. 1234@async.coroutinedef fetch(self,url):">
<meta property="og:locale" content="ko">
<meta property="og:updated_time" content="2021-01-25T08:36:06.083Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="비동기 코루틴 번역-2">
<meta name="twitter:description" content="Coroutines 우리는 당신을 Promise로 유도하고 싶다. 비동기처리에 대해서 콜백의 효율성과 조합하여 과거 멀티쓰레딩 프로그래밍의 클래식한 것을 사용해서 작성하는 것이 가능하다. 이 조합은 &amp;quot;Coroutine&amp;quot;이라는 패턴과 함께 얻을 수 있는 것이다. 1234@async.coroutinedef fetch(self,url):">
  
    <link rel="alternate" href="/atom.xml" title="Junehan&#39;s workbook" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Junehan&#39;s workbook</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">work flow and descriptions</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="검색"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://codenamenadja.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-python/post/async_coroutine_2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/06/19/python/post/async_coroutine_2/" class="article-date">
  <time datetime="2019-06-19T09:11:02.000Z" itemprop="datePublished">2019-06-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      비동기 코루틴 번역-2
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="coroutines"><a class="markdownIt-Anchor" href="#coroutines"></a> Coroutines</h2>
<p>우리는 당신을 Promise로 유도하고 싶다.<br>
비동기처리에 대해서 콜백의 효율성과 조합하여 과거 멀티쓰레딩 프로그래밍의 클래식한 것을 사용해서 작성하는 것이 가능하다.<br>
이 조합은 &quot;Coroutine&quot;이라는 패턴과 함께 얻을 수 있는 것이다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@async.coroutine</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fetch</span><span class="params">(self,url)</span>:</span></span><br><span class="line">    respnse = <span class="keyword">yield</span> <span class="keyword">from</span> self.session.get(url) <span class="comment"># 콜백의 첫 단계</span></span><br><span class="line">    body = <span class="keyword">yield</span> <span class="keyword">from</span> response.read() <span class="comment"># 연속적 이벤트에 대한 콜백</span></span><br></pre></td></tr></table></figure>
<p>이것은 또한 스케일러블하다. 멀티쓰레딩으로 작업하던 당시, 50Kb의 자원이<br>
하나의 쓰레드를 생성하는데 들어갔었고, OS는 그것에 대해 엄격한 CAPs를 적용하고 있었다.<br>
그러나 파이썬의 코루틴은 거의 3K만을 차지하고 있고,<br>
따라서 매우 쉽게 수십만개의 코루틴한 객체들을 생성하고 실행할 수 있다.</p>
<hr>
<h3 id="코루틴에-대한-컨셉은-아주-쉽다-고전적인-컴퓨터-과학과-비추어-봤을때"><a class="markdownIt-Anchor" href="#코루틴에-대한-컨셉은-아주-쉽다-고전적인-컴퓨터-과학과-비추어-봤을때"></a> 코루틴에 대한 컨셉은 아주 쉽다!!? (고전적인 컴퓨터 과학과 비추어 봤을때…)</h3>
<p>그것은 서브루틴(함수 개념)이며 멈출 수 있고 다시 진입 할 수 있다.</p>
<p>반면에 쓰레드는 우선적으로(OS가 강제력을 가지는 스케쥴링 방식) OS에 의해 멀티테스킹 되어진다.<br>
<code>asyncio</code>라이브러리에 구현되어 있는 코루틴들은 제너레이터를 기반으로 구성 되어 있다.<br>
Future class와 <code>yield from</code>선언자가 그것이다.</p>
<p>그것은 파이썬의 프라이빗 힙 중 스텍프레임에 직속으로 할당되는 프레임들이기에,<br>
기존의 메인 쓰레드를 중심으로 생성된 쓰레드가 스텍프레임으로서 레벨에 존재한다.</p>
<p>개별적으로 이전의 공유자원에 대해 접근할 수 있지만, <strong>Race condition</strong>이 발생할 수 있고,<br>
프로그래머 레벨에서 <strong>MUTEX(Mutual exclusion)</strong> 처리로 핸들링을 해주거나,<br>
세마포어 기법을 통해 멀티프로그래밍 환경에서 실행자들이 임계구역(공유자원)에<br>
접근하기 전에 각각 전처리, 후처리 등을 추가하는 방법이 있다.</p>
<blockquote>
<p>MUTEX는 기본적으로 작동원리의 레벨이나, 그 기저에 위치한 것이 아니라, 업무의 할당이라는 개념으로 로직-코드레벨에서 직접 제어하는 것이다.</p>
</blockquote>
<p>그러나 코루틴은 자신이 서브루틴으로서 직접 언제 멈출지, 이후 어떤 코루틴을 실행할 지 선택할 수 있다.<br>
코루틴에 대한 많은 실행법이 있지만, (“파이썬만 해도 여러가지를 가지고 있다!”)</p>
<ol>
<li>스탠다드 라이브러리 &quot;asyncio&quot;에 있는 코루틴들은 제너레이터를 기반으로 만들어져 있다</li>
<li>Future class</li>
<li><code>yield from CALLBACK_on_Socket_connected()</code></li>
</ol>
<p>yield 하는 싱글 스레드의 주도권은 일시적을 해당 제너레이터로 넘어간다.<br>
yield from 을 통해 외부 Global frame에서 전달받은 것은 자신의 프레임 내부로 가져온다.<br>
routine과 위와 같은 방식으로 소통한다.</p>
<p>python.exe입장에서는 자신의 프로세스가 늘어나는것도, 공식적인 쓰레드가 늘어나는 것도 아니어서, OS에 대해서 영향을 주는 것이 아니다.<br>
그저 자신의 기존 스텍에 대해서 혼란을 주지 않고, 힙에 있는 가스텍을 메인스텍으로 대체한다는 개념에 더욱 가깝다.</p>
<p>파이썬 3.5로 부터, 코루틴은 파이썬 언어의 네이티브한 특성이 되었다.<br>
3.4버전 부터 구현된 코루틴을 기존의 언어의 자원을 이용하여 이해하는 것은<br>
3.5버전의 네이티브 코루틴을 걸고넘어지는 기초가 된다.</p>
<p>3.4버전의 제너레이터 기반의 코루틴을 설명하기 위해서, 우리는 일단 제너레이터를 이해하는 것부터 시작해서,<br>
어떻게 그들이 <code>asyncio</code>에서 코루틴으로 사용되었는지 접근 해야한다.<br>
제너레이터 기반 코루틴을 설명하고 나면, 그것을 기꺼이 비동기적 웹 크롤러에 사용할 것이다.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://codenamenadja.github.io/2019/06/19/python/post/async_coroutine_2/" data-id="ckkdb52hh002b1pqkcxwfu1d3" class="article-share-link">공유</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python-post/">python post</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/06/19/python/post/async_coroutine_1/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">최신</strong>
      <div class="article-nav-title">
        
          비동기 코루틴 번역-1
        
      </div>
    </a>
  
  
    <a href="/2019/06/19/python/post/async_coroutine_4/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">이전</strong>
      <div class="article-nav-title">비동기 코루틴 번역-4</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">태그</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/c/">c</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/custom-module/">custom module</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/django/">django</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fabric/">fabric</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/functional-programming/">functional programming</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo-deploy/">hexo-deploy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http/">http</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/network/">network</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pipenv/">pipenv</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/postgresql/">postgresql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/project/">project</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python-module/">python module</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python-post/">python post</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sql/">sql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/testing/">testing</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/travel-note/">travel_note</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tutorial/">tutorial</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">태그 클라우드</h3>
    <div class="widget tagcloud">
      <a href="/tags/c/" style="font-size: 11.43px;">c</a> <a href="/tags/custom-module/" style="font-size: 12.86px;">custom module</a> <a href="/tags/django/" style="font-size: 14.29px;">django</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/fabric/" style="font-size: 10px;">fabric</a> <a href="/tags/functional-programming/" style="font-size: 11.43px;">functional programming</a> <a href="/tags/hexo-deploy/" style="font-size: 10px;">hexo-deploy</a> <a href="/tags/http/" style="font-size: 11.43px;">http</a> <a href="/tags/linux/" style="font-size: 15.71px;">linux</a> <a href="/tags/network/" style="font-size: 11.43px;">network</a> <a href="/tags/nginx/" style="font-size: 10px;">nginx</a> <a href="/tags/pipenv/" style="font-size: 10px;">pipenv</a> <a href="/tags/postgresql/" style="font-size: 10px;">postgresql</a> <a href="/tags/project/" style="font-size: 10px;">project</a> <a href="/tags/python/" style="font-size: 20px;">python</a> <a href="/tags/python-module/" style="font-size: 17.14px;">python module</a> <a href="/tags/python-post/" style="font-size: 18.57px;">python post</a> <a href="/tags/sql/" style="font-size: 10px;">sql</a> <a href="/tags/testing/" style="font-size: 10px;">testing</a> <a href="/tags/travel-note/" style="font-size: 10px;">travel_note</a> <a href="/tags/tutorial/" style="font-size: 10px;">tutorial</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">아카이브</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">1월 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">9월 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">8월 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">7월 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">6월 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">5월 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">최근 포스트</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/01/26/fastcamp/my_post/">test_post</a>
          </li>
        
          <li>
            <a href="/2019/09/17/http/2_http_sementics/">http_1.0_sementics</a>
          </li>
        
          <li>
            <a href="/2019/09/09/project/travel_note/">travel_note 서비스 고찰</a>
          </li>
        
          <li>
            <a href="/2019/09/06/http/1_http_1.0_basic_four_feature/">http/1.0의 신택스: 기본이 되는 네가지 요소</a>
          </li>
        
          <li>
            <a href="/2019/09/05/python/post/async_coroutine_5/">비동기 코루틴 번역-5-End</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 junehan<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>